---
title: 网络流模板
top_img: false
date: 2023-01-01 23:29:32
tags:
- 图论
- 网络流
categories:
- 信息学
- 笔记
---
{% note flat info %}
存个模板,放个[链接](https://oi.wiki/graph/flow/).
{% endnote %}
# 最大流
## EK
```c++
bool bl[maxn];
struct tmppre
{
	int point,edge;
}pre[maxn];
bool bfs(void)
{
	queue<int>que;
	memset(bl,0,sizeof bl);
	que.push(s);
	bl[s]=true;
	while(!que.empty())
	{
		int dc=que.front();
		que.pop();
		for(register int i=head[dc];i;i=edge[i].next)
		if(!bl[edge[i].to]&&edge[i].w)
		{
			pre[edge[i].to].point=dc;
			pre[edge[i].to].edge=i;
			if(!(edge[i].to^t))return true;
			que.push((edge[i].to));
			bl[edge[i].to]=true;
		}
	}
	return false;
}
long long ans=0;
void ek(void)
{
	int minn;
	while(bfs())
	{
		minn=0x7f7f7f7f;
		for(register int i=t;i^s;i=pre[i].point)
		{
			minn=(minn>edge[pre[i].edge].w)?edge[pre[i].edge].w:minn;
		}
		for(register int i=t;i^s;i=pre[i].point)
		{
			edge[pre[i].edge].w-=minn;
			edge[pre[i].edge^1].w+=minn;
		}
		ans+=minn;
	}
}
```
## DINIC
```c++
bool bl[maxn];int cur[maxn],dis[maxn];
bool bfs(void)
{
	memset(bl,0,sizeof bl);
	queue<int>que;
	bl[s]=true;
	dis[s]=0;
	que.emplace(s);
	while(!que.empty())
	{
		int dc=que.front();
		que.pop();
		for(register int j=head[dc];j;j=edge[j].next)
		if(!bl[edge[j].to]&&edge[j].w)
		{
			dis[edge[j].to]=dis[dc]+1;
			bl[edge[j].to]=true;
			que.emplace(edge[j].to);
		}
	}
	return bl[t];
}
ll dfs(int dc,ll flow)
{
	if(dc==t||flow==0)return flow;
	ll dcflow=0,f;
	for(register int j=cur[dc];j;j=edge[j].next)
	{
		cur[dc]=j;
		if(dis[edge[j].to]==dis[dc]+1&&(f=dfs(edge[j].to,min((ll)edge[j].w,flow))))//水太少，管子太细，流量都不会多hhh
		{
			dcflow+=f;
			flow-=f;
			edge[j].w-=f;
			edge[j^1].w+=f;
		}
	}
	return dcflow;
}
ll dinic(void)
{
	ll ans=0;
	while(bfs())
	{
		fru(i,1,n)cur[i]=head[i];
		ans+=dfs(s,LLONG_MAX);
	}
	return ans;
}
```
![image](https://images2017.cnblogs.com/blog/1101696/201802/1101696-20180212074250859-1560811086.png)