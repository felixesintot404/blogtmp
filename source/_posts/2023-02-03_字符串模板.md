---
title: 字符串模板
top_img: false
date: 2023-02-03 10:01:32
tags:
- 字符串
categories:
- 信息学
- 笔记
---
# KMP
{% note flat info %}
设字符串下标从`0`开始，$dc$ 为当前模式串 $s$ 判断的下标，$prel_i$ 为 $s[0,i]$ 中最长前缀后缀相等长度，当匹配失败时正好需要会退到下标 $pre_{dc-1}$~~，所以c++世界无敌。~~
{% endnote %}
[模板题](https://www.luogu.com.cn/problem/P3375)的代码：
```c++
//头文件等等不用看了吧
//in，out：整数读写；pc就是putchar；fru/frd(i,j,k)就是定义i从j“for”到k
int l1,l2,prel[maxn],dc;//prel就是上文的prel
string s1,s2;
int main()
{
	cin>>s1>>s2;
	l1=s1.size();l2=s2.size();
	for(register int i=1;i<l2;i++)
	{
		while(dc&&s2[dc]^s2[i])dc=prel[dc-1];
		if(s2[dc]==s2[i])dc++;
		prel[i]=dc;
	}
	dc=0;
	for(register int i=0;i<l1;i++)
	{
		while(dc&&s2[dc]^s1[i])dc=prel[dc-1];
		if(s2[dc]==s1[i])dc++;
		if(dc==l2)
		{
			out(i-l2+2);pc('\n');
			dc=prel[dc-1];
		}
	}
	for(register int i=0;i<l2;i++)
	{
		out(prel[i]);pc(' ');
	}
	return 0;
}
```