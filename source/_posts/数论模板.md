---
abbrlink: ''
categories:
- - ç¬”è®°
date: '2023-06-08T22:38:00.825569+08:00'
tags:
- é‡è¦æ¨¡æ¿
- æ•°è®º
title: æ•°è®ºæ¨¡æ¿
top_img: false
updated: 2023-6-8T23:5:38.244+8:0
---
# FFT/è™šæ•°

æœ€åçš„ä»£ç çœŸçš„åªæœ‰FFTç®—å­æœ¬èº«ï¼Œæ€ç»´è¿‡ç¨‹ä¸€ç‚¹æ²¡æœ‰ğŸ˜­ ã€‚

è®¡ç®—çŸ©é˜µï¼ˆè¿™é‡Œè®¾ $0\leqslant{i,j}\leqslant{n-1}$ï¼‰ï¼š

DFTï¼š$A_{i,j}=W_n^{ij}$

IDFTï¼š$A_{i,j}=\cfrac{-W_n^{ij}}n$

æ³¨æ„è¿ç®—å‰ä¸€å®šè¦æŠŠ $n$ è¡¥æˆ $2^k$ çš„å½¢å¼ã€‚

```c++
//è™šæ•°ç±»
struct cpl
{
    double a,b;
    cpl operator+(cpl y)
    {
        return (cpl){a+y.a,b+y.b};
    }
    cpl operator-(cpl y)
    {
        return (cpl){a-y.a,b-y.b};
    }
    cpl operator*(cpl y)
    {
        return (cpl){a*y.a-b*y.b,b*y.a+a*y.b};
    }
};
//FFTå‡½æ•°
int v[maxn];
void fft(cpl cl[],int len,bool ck)
{
    int lt=(1<<len);
    fru(i,0,lt-1)
    {
        v[i]=v[i>>1]>>1;
        if(i&1)
        {
            v[i]|=(lt>>1);
        }
        if(v[i]>i)swap(cl[i],cl[v[i]]);
    }
    cpl w,w1,T1,T2;
    for(register int i=1;i<lt;i<<=1)
    {
        w1=ck?(cpl){cos(-2.0*pi/(i<<1)),sin(-2.0*pi/(i<<1))}:(cpl){cos(2.0*pi/(i<<1)),sin(2.0*pi/(i<<1))};
        for(register int j=0;j<lt;j+=(i<<1))
        {
            w=(cpl){1,0};
            for(register int k=j;k<i+j;k++)
            {
                // cout<<k<<' '<<k+i<<endl;
                T1=cl[k]+(w*cl[k+i]);
                T2=cl[k]-(w*cl[k+i]);
                cl[k]=T1;cl[k+i]=T2;
                w=w*w1;
            }
        }
    }
    if(ck)fru(i,0,lt-1)cl[i].a/=lt;
}
```
