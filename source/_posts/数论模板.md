---
abbrlink: ''
categories:
- - ç¬”è®°
date: '2023-06-08T22:38:00.825569+08:00'
tags:
- é‡è¦æ¨¡æ¿
- æ•°è®º
title: æ•°è®ºæ¨¡æ¿
top_img: false
updated: 2023-7-26T20:6:13.838+8:0
---
# å¿«é€Ÿå¹‚&å–ä½™è¿ç®—

$O(\log_2{b})$ æ±‚ $a^b \operatorname{mod} p$ã€‚

```c++
ll poww(ll a,ll b,ll p)
{
    ll ans=1;
    while(b)
    {
        if(b&1)ans=(ans*a)%p;
        a=(a*a)%p;
        b>>=1;
    }
    return ans;
}
```

# çº¿æ€§ç­›ï¼ˆæ¬§æ‹‰ç­›ï¼‰

åŸƒæ°ç­›æ—¶é—´å¤æ‚åº¦ä¸º $O(n\log\log{n})$ï¼Œçº¿æ€§ç­›ä¸º $O(n)$ã€‚

```c++
bool p[/*å€¼åŸŸ*/];
int prime[/*å€¼åŸŸ*/>>1],tot,n;
inline void getprime(void)
{
    p[1]=true;
    for(int i=2;i<=n;i++)
    {
        if(!p[i])prime[++tot]=i;
        for(int j=1;j<=tot&&prime[j]*i<=n;j++)
        {
        	p[prime[j]*i]=true;
        	if(i%prime[j]==0)break;
    	}
    }
}
```

## çº¿ç­›è®¡ç®—æ¬§æ‹‰å‡½æ•°

æ¬§æ‹‰å‡½æ•°ï¼š$\varphi(x)$ è¡¨ç¤º $\leqslant{x}$ ä¸”ä¸ $x$ äº’è´¨çš„æ­£æ•´æ•°ä¸ªæ•°ï¼Œå¦‚ï¼š$\varphi(1)=1$ï¼Œ$\varphi(p)=p-1$ã€‚

æ¬§æ‹‰å®šç†ï¼šå½“ $\gcd(a,m)=1$ æ—¶æœ‰ $a^{\varphi(m)}\equiv 1$ã€‚

æ‹“å±•æ¬§æ‹‰å®šç†ï¼š

$$
a^b \equiv \begin{cases}
  a^{b \bmod \varphi(m)},                &\gcd(a,m) =  1,                   \\
  a^b,                                   &\gcd(a,m)\ne 1, b <   \varphi(m), \\
  a^{(b \bmod \varphi(m)) + \varphi(m)}, &\gcd(a,m)\ne 1, b \ge \varphi(m).
\end{cases} \pmod m
$$

```c++
bool bl[/*å€¼åŸŸ*/];
int pme[/*å€¼åŸŸ*/>>1],tot;
ll phi[/*å€¼åŸŸ*/],md;
void getphi(void)
{
	bl[1]=true;phi[1]=1;
	fru(i,2,/*å€¼åŸŸ*/)
	{
		if(!bl[i])
		{
			pme[++tot]=i;phi[i]=i-1;
		}
		for(register int j=1;i*pme[j]<=/*å€¼åŸŸ*/&&j<=tot;j++)
		{
			bl[i*pme[j]]=true;
			if(i%pme[j])
			{
				phi[i*pme[j]]=phi[i]*phi[pme[j]];
			}
			else
			{
				phi[i*pme[j]]=phi[i]*pme[j];
				break;
			}
		}
	}
}
```

# æœ€å¤§å…¬çº¦æ•°ï¼ˆGCDï¼‰

é€’å½’ç‰ˆï¼š

```c++
int gcd(int a,int b)
{
	return b?gcd(b,a%b):a;
}
```

éé€’å½’ç‰ˆï¼š

```c++
int gcd(int a,int b)
{
	int tm;
	while(b)
	{
		tm=a%b;
		a=b;
		b=tm;
	}
	return a;
}
```

## æ‹“å±•æ¬§å‡ é‡Œå¾—ï¼ˆexGCDï¼‰

æ ¹æ®è´ç¥–å®šç†ï¼Œä¸å®šæ–¹ç¨‹ $ax+by=c$ å½“ä¸”ä»…å½“ $\gcd(a,b)|c$ çš„æ—¶å€™æœ‰è§£ã€‚

å› æ­¤åªéœ€å¯¹ $ax+by=\gcd(a,b)$ æ±‚è§£å³å¯ã€‚

ä»¥ä¸‹ä»£ç åœ¨ $O(\log n)$ çš„æ—¶é—´æ±‚å‡º $\gcd(a,b)$ å¹¶ä¸”ç»™å‡ºäº†ä¸€ç»„ç‰¹è§£ $x_0$ï¼Œ$y_0$ã€‚

ä¹‹åå³å¯ä½¿ç”¨

$$
\begin{cases}
x=x_0+\cfrac {kb}{\gcd(a,b)} \\
y=y_0-\cfrac {ka}{\gcd(a,b)}
\end{cases}(k\in\Z)
$$

å¾—åˆ°å…¶ä»–æ‰€æœ‰è§£ã€‚

```c++
int exgcd(int a,int b,int& x,int& y)
{
	if(!b)
	{
		x=1;y=0;
		return a;
	}
	int td=exgcd(b,a%b,x,y),tx;tx=x;
	x=y;
	y=(tx-a/b*y);
	return td;
}
```

# FFT/è™šæ•°

> åæ§½ï¼šæœ€åçš„ä»£ç çœŸçš„åªæœ‰FFTç®—å­æœ¬èº«ï¼Œæ€ç»´è¿‡ç¨‹çš„ä½“ç°ä¸€ç‚¹æ²¡æœ‰ğŸ˜­ ï¼Œ~~éš¾æ€ªæˆ‘çœ‹äº†å‡ å°æ—¶ä»£ç æ„£æ˜¯å•¥éƒ½æ²¡çœ‹å‡ºæ¥~~ã€‚

è®¡ç®—çŸ©é˜µï¼ˆè¿™é‡Œè®¾ $0\leqslant{i,j}\leqslant{n-1}$ï¼‰ï¼š

DFTï¼š$A_{i,j}=W_n^{ij}$

IDFTï¼š$A_{i,j}=\cfrac{-W_n^{ij}}n$

ä»¥ä¸Šä¸¤çŸ©é˜µä¹‹ç§¯æ­£å¥½ä¸ºä¸€ä¸ªå•ä½çŸ©é˜µï¼Œ

æ³¨æ„è¿ç®—å‰ä¸€å®šè¦æŠŠ $n$ è¡¥æˆ $2^k$ çš„å½¢å¼ã€‚

```c++
//è™šæ•°ç±»
struct cpl
{
    double a,b;
    cpl operator+(cpl y)
    {
        return (cpl){a+y.a,b+y.b};
    }
    cpl operator-(cpl y)
    {
        return (cpl){a-y.a,b-y.b};
    }
    cpl operator*(cpl y)
    {
        return (cpl){a*y.a-b*y.b,b*y.a+a*y.b};
    }
};
//FFTå‡½æ•°
int v[maxn];
void fft(cpl cl[],int len,bool ck)
{
    int lt=(1<<len);
    fru(i,0,lt-1)
    {
        v[i]=v[i>>1]>>1;
        if(i&1)
        {
            v[i]|=(lt>>1);
        }
        if(v[i]>i)swap(cl[i],cl[v[i]]);
    }
    cpl w,w1,T1,T2;
    for(register int i=1;i<lt;i<<=1)
    {
        w1=ck?(cpl){cos(-2.0*pi/(i<<1)),sin(-2.0*pi/(i<<1))}:(cpl){cos(2.0*pi/(i<<1)),sin(2.0*pi/(i<<1))};
        for(register int j=0;j<lt;j+=(i<<1))
        {
            w=(cpl){1,0};
            for(register int k=j;k<i+j;k++)
            {
                // cout<<k<<' '<<k+i<<endl;
                T1=cl[k]+(w*cl[k+i]);
                T2=cl[k]-(w*cl[k+i]);
                cl[k]=T1;cl[k+i]=T2;
                w=w*w1;
            }
        }
    }
    if(ck)fru(i,0,lt-1)cl[i].a/=lt;
}
```
